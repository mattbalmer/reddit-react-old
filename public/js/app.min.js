!function(a,b){b.reddit=a,api=function(){var a={};return a.request=function(a){var b=new XMLHttpRequest,c=Q.defer();return b.open("GET",a,!0),b.onload=function(){if(b.status>=200&&b.status<400){try{var a=JSON.parse(b.responseText);b.data=a}catch(d){b.data={}}c.resolve(b)}else b.data={},c.reject(b)},b.onerror=function(){c.reject(b)},b.send(),c.promise},a.r=function(b){return a.request("/r/"+b)},a}();var c=React.createClass({displayName:"PostList",getInitialState:function(){return{activePost:{}}},onTabSelected:function(a){this.state.activePost==a&&(a={}),this.setState({activePost:a})},render:function(){var a=this.props.posts.map(function(a,b){return d({post:a,id:b,onClick:this.onTabSelected,activePost:this.state.activePost})},this);return React.DOM.section({className:"posts"},a)}}),d=React.createClass({displayName:"Post",onClick:function(){this.props.onClick(this.props.post.data)},render:function(){var a=this.props.post.data,b=React.addons.classSet,c=b({post:!0,active:a.id==this.props.activePost.id});return React.DOM.div({className:c,onClick:this.onClick},React.DOM.span({className:"id"},this.props.id),React.DOM.span({className:"score"},a.score),React.DOM.img({className:"thumb",src:a.thumbnail}),React.DOM.section({className:"details"},React.DOM.a({target:"_blank",href:a.url,className:"title"},a.title),React.DOM.span({className:"author"},a.author),React.DOM.span({className:"comment-count"},a.num_comments)))}}),e=React.createClass({displayName:"SortOption",onClick:function(){console.log("CLICK!",this.props.mode),h.fetch("all",this.props.mode.toLowerCase())},render:function(){var a=this.props.mode.toLowerCase(),b=a+" btn btn-default";return this.props.active&&(b+=" active"),React.DOM.button({type:"button",onClick:this.onClick,className:b},this.props.mode)}}),f=React.createClass({displayName:"Sort",render:function(){var a=(React.addons.classSet,this.props.mode),b=["Hot","New","Top"],c=b.map(function(b){return e({mode:b,active:b.toLowerCase()==a.toLowerCase()})});return React.DOM.div({className:"btn-group"},c)}}),g=React.createClass({displayName:"SubredditSearch",getInitialState:function(){return{value:this.props.title||"all"}},onSubmit:function(){return this.refs.searchInput.getDOMNode().blur(),h.fetch(this.state.value),!1},onChange:function(a){this.setState({value:a.target.value})},render:function(){var a=this.state.value;return React.DOM.form({className:"form-inline",onSubmit:this.onSubmit},React.DOM.div({className:"input-group"},React.DOM.input({ref:"searchInput",type:"text",className:"form-control",value:a,onChange:this.onChange}),React.DOM.div({className:"input-group-btn"},React.DOM.button({type:"submit",onClick:this.onSubmit,className:"btn btn-primary"},"Go"))))}}),h=function(a){var b={};return b.fetch=function(b,d){d=d||"hot",a.r(b+"/"+d).then(function(a){var b=a.data.data.children;React.renderComponent(c({posts:b}),document.getElementById("Main")),React.renderComponent(g(null),document.getElementById("SubredditSearch")),React.renderComponent(f({mode:d}),document.getElementById("SortOptions"))})},b.fetch("all"),b}(api);"undefined"!=typeof b&&(b.reddit=h)}({},function(){return this}());